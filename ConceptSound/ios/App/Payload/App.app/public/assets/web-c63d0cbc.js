import{W as c}from"./index-a68b0121.js";class u extends c{constructor(){super(...arguments),this.ERROR_PICK_FILE_CANCELED="pickFiles canceled."}async convertHeicToJpeg(e){throw this.unimplemented("Not implemented on web.")}async pickFiles(e){const i=await this.openFilePicker(e);if(!i)throw new Error(this.ERROR_PICK_FILE_CANCELED);const n={files:[]};for(const t of i){const r={blob:t,modifiedAt:t.lastModified,mimeType:this.getMimeTypeFromUrl(t),name:this.getNameFromUrl(t),path:void 0,size:this.getSizeFromUrl(t)};e!=null&&e.readData&&(r.data=await this.getDataFromFile(t)),n.files.push(r)}return n}async pickImages(e){return this.pickFiles(Object.assign({types:["image/*"]},e))}async pickMedia(e){return this.pickFiles(Object.assign({types:["image/*","video/*"]},e))}async pickVideos(e){return this.pickFiles(Object.assign({types:["video/*"]},e))}async openFilePicker(e){var i;const n=((i=e==null?void 0:e.types)===null||i===void 0?void 0:i.join(","))||"",t=!!(e!=null&&e.multiple);return new Promise(r=>{let a=!1;const s=document.createElement("input");s.type="file",s.accept=n,s.multiple=t,s.addEventListener("change",()=>{a=!0;const l=Array.from(s.files||[]);r(l)},{once:!0}),window.addEventListener("focus",async()=>{await this.wait(1e3),!a&&r(void 0)},{once:!0}),s.click()})}async getDataFromFile(e){return new Promise((i,n)=>{const t=new FileReader;t.readAsDataURL(e),t.onload=()=>{const s=(typeof t.result=="string"?t.result:"").split("base64,")[1]||"";i(s)},t.onerror=r=>{n(r)}})}getNameFromUrl(e){return e.name}getMimeTypeFromUrl(e){return e.type}getSizeFromUrl(e){return e.size}async wait(e){return new Promise(i=>setTimeout(i,e))}}export{u as FilePickerWeb};
